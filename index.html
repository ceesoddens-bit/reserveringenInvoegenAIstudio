<!DOCTYPE html>
<html lang="nl" class="dark">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='feather feather-calendar'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Restaurant Reservering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      /* Simple scrollbar styling for a more modern look */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #111827; /* bg-gray-900 */
      }
      ::-webkit-scrollbar-thumb {
        background: #4b5563; /* bg-gray-600 */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #6b7280; /* bg-gray-500 */
      }
      /* Style for date/time picker icon */
      input[type="date"]::-webkit-calendar-picker-indicator,
      input[type="time"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        cursor: pointer;
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/"
  }
}
</script>
</head>
  <body class="bg-gray-900 text-gray-200">
    <div id="root"></div>
    <script type="module">
      import React, { useState, useCallback } from 'react';
      import ReactDOM from 'react-dom/client';

      const WEBHOOK_URL = 'https://ceesodd.app.n8n.cloud/webhook/b92c007f-f797-4739-b5c5-35293bf9d959';

      const initialFormData = {
        datum: '',
        tijd: '',
        naam: '',
        telefoon: '',
        email: '',
        gasten: 1,
        aantekeningen: '',
        bevestigingsmail: true,
      };

      // SVG Icon Components
      const CheckCircleIcon = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      );

      const ExclamationCircleIcon = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      );

      const SpinnerIcon = ({ className }) => (
          <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
              <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
      );

      const App = () => {
        const [formData, setFormData] = useState(initialFormData);
        const [isLoading, setIsLoading] = useState(false);
        const [submissionStatus, setSubmissionStatus] = useState('idle');
        const [statusMessage, setStatusMessage] = useState('');

        const handleChange = useCallback((e) => {
          const { name, value, type } = e.target;
          
          if (type === 'checkbox') {
            const { checked } = e.target;
            setFormData(prev => ({ ...prev, [name]: checked }));
          } else if (type === 'number') {
            const numValue = parseInt(value, 10);
            setFormData(prev => ({ ...prev, [name]: numValue > 0 ? numValue : 1 }));
          } else {
            setFormData(prev => ({ ...prev, [name]: value }));
          }
        }, []);

        const getFormattedTimestamp = () => {
          const now = new Date();
          const pad = (num) => num.toString().padStart(2, '0');

          const day = pad(now.getDate());
          const month = pad(now.getMonth() + 1);
          const year = now.getFullYear();

          const hours = pad(now.getHours());
          const minutes = pad(now.getMinutes());
          const seconds = pad(now.getSeconds());

          return `${day}-${month}-${year} ${hours}:${minutes}:${seconds}`;
        };

        const handleSubmit = async (e) => {
          e.preventDefault();
          setIsLoading(true);
          setSubmissionStatus('idle');
          setStatusMessage('');

          const payload = {
            ...formData,
            gasten: String(formData.gasten),
            verzonden_op: getFormattedTimestamp(),
          };

          try {
            const response = await fetch(WEBHOOK_URL, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(payload),
            });

            const responseBody = await response.text();

            if (!response.ok) {
              throw new Error(responseBody || `HTTP error! status: ${response.status}`);
            }
            
            let successMsg = 'Reservering succesvol verzonden!';
            try {
              const jsonResponse = JSON.parse(responseBody);
              successMsg = jsonResponse.message || responseBody;
            } catch (e) {
              successMsg = responseBody || successMsg;
            }

            setStatusMessage(successMsg);
            setSubmissionStatus('success');
            setFormData(initialFormData);
          } catch (error) {
            console.error('Submission failed:', error);
            const errorMessage = error instanceof Error ? error.message : 'Er is iets misgegaan. Probeer het opnieuw.';
            setStatusMessage(errorMessage);
            setSubmissionStatus('error');
          } finally {
            setIsLoading(false);
          }
        };
        
        const minDate = new Date().toISOString().split('T')[0];

        return (
          <div className="min-h-screen flex items-center justify-center p-4 bg-gray-900">
            <div className="w-full max-w-lg mx-auto bg-gray-800 shadow-2xl rounded-2xl p-6 sm:p-8">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-white">Reserveer een Tafel</h1>
                <p className="text-gray-400 mt-2">Vul het formulier in om uw reservering te plaatsen.</p>
              </div>

              {submissionStatus === 'success' && (
                <div className="bg-green-900/50 border border-green-700 text-green-300 px-4 py-3 rounded-lg relative mb-6 flex items-center" role="alert">
                  <CheckCircleIcon className="w-6 h-6 mr-3" />
                  <span className="block sm:inline">{statusMessage}</span>
                </div>
              )}

              {submissionStatus === 'error' && (
                <div className="bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-lg relative mb-6 flex items-center" role="alert">
                  <ExclamationCircleIcon className="w-6 h-6 mr-3" />
                  <span className="block sm:inline">{statusMessage}</span>
                </div>
              )}

              <form onSubmit={handleSubmit} className="space-y-6">
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                  <div>
                    <label htmlFor="datum" className="block text-sm font-medium text-gray-300 mb-1">Datum</label>
                    <input type="date" id="datum" name="datum" value={formData.datum} onChange={handleChange} required min={minDate} className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                  </div>
                  <div>
                    <label htmlFor="tijd" className="block text-sm font-medium text-gray-300 mb-1">Tijd</label>
                    <input type="time" id="tijd" name="tijd" value={formData.tijd} onChange={handleChange} required className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                  </div>
                </div>

                <div>
                  <label htmlFor="naam" className="block text-sm font-medium text-gray-300 mb-1">Naam</label>
                  <input type="text" id="naam" name="naam" value={formData.naam} onChange={handleChange} required placeholder="Uw volledige naam" className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                </div>

                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                  <div>
                    <label htmlFor="telefoon" className="block text-sm font-medium text-gray-300 mb-1">Telefoonnummer</label>
                    <input type="tel" id="telefoon" name="telefoon" value={formData.telefoon} onChange={handleChange} required placeholder="06 12345678" className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                  </div>
                  <div>
                    <label htmlFor="email" className="block text-sm font-medium text-gray-300 mb-1">E-mailadres</label>
                    <input type="email" id="email" name="email" value={formData.email} onChange={handleChange} required placeholder="u@voorbeeld.nl" className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                  </div>
                </div>
                
                <div>
                  <label htmlFor="gasten" className="block text-sm font-medium text-gray-300 mb-1">Aantal gasten</label>
                  <input type="number" id="gasten" name="gasten" value={formData.gasten} onChange={handleChange} required min="1" className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"/>
                </div>

                <div>
                  <label htmlFor="aantekeningen" className="block text-sm font-medium text-gray-300 mb-1">Aantekeningen</label>
                  <textarea id="aantekeningen" name="aantekeningen" value={formData.aantekeningen} onChange={handleChange} rows={3} placeholder="Bijv. allergieÃ«n, kinderstoel, etc." className="w-full bg-gray-700 border border-gray-600 text-white rounded-md p-2.5 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"></textarea>
                </div>
                
                <div className="flex items-center">
                  <input id="bevestigingsmail" name="bevestigingsmail" type="checkbox" checked={formData.bevestigingsmail} onChange={handleChange} className="h-4 w-4 rounded border-gray-500 bg-gray-600 text-blue-500 focus:ring-blue-600"/>
                  <label htmlFor="bevestigingsmail" className="ml-3 block text-sm text-gray-300">Stuur mij een bevestigingsmail</label>
                </div>

                <div>
                  <button type="submit" disabled={isLoading} className="w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500 disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors">
                    {isLoading ? (
                      <>
                        <SpinnerIcon className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" />
                        Verzenden...
                      </>
                    ) : (
                      'Verzenden'
                    )}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }

      const root = ReactDOM.createRoot(rootElement);
      root.render(
        <React.StrictMode>
          <App />
        </React.StrictMode>
      );
    </script>
  </body>
</html>
